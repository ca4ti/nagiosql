<!-- Version 2.0.2 -->
<!-- Last modified 12.03.2007 -->
<!-- BEGIN header -->
    <td class="main">
      <h1>{TITLE}</h1>
<!-- END header -->
<!-- BEGIN datainsert -->
<h2>{TITLE_FORM}</h2>
<form name="frmHostEscInsert" method="post" action="{ACTION_INSERT}">
  <script language="JavaScript" type="text/JavaScript">
    <!--
    // Eingabe abbrechen
    function abort() {
      this.location.href = "{ACTION_INSERT}?limit={LIMIT}";
    }
    // Formular absenden
    function LockButton() {
      if (checkForm() == false) {
        return false;
      } else {
        document.frmHostEscInsert.submit();
        document.frmHostEscInsert.subForm.disabled = true;
      }
    }
    // Formulareingaben überprüfen
    function checkForm() {
	  // Sind Hosts oder Hostgruppen ausgewählt?
      if((document.frmHostEscInsert.selHost.value == 0) &&
	    (document.frmHostEscInsert.selHostGroup.value == 0)){
        alert("{FILL_HOST_GR}");
        document.frmHostEscInsert.selHost.focus();
        return false;
      }
      // Sind Hosts und Hostgruppen gleichzeitigausgewählt?
      if((document.frmHostEscInsert.selHost.value != 0) &&
	    (document.frmHostEscInsert.selHostGroup.value != 0)){
        alert("{FILL_HOSTORGR}");
        document.frmHostEscInsert.selHost.focus();
        return false;
      }
	  // Ist der Konfigurationsname leer?
      if(document.frmHostEscInsert.tfConfigName.value == "") {
        alert("{FILL_CONFIG}");
        document.frmHostEscInsert.tfConfigName.focus();
        return false;
      }
	  // Fehlt die erste Alarmierungszeit?
      if(document.frmHostEscInsert.tfFirstNotif.value == "") {
        alert("{FILL_FIRSTNF}");
        document.frmHostEscInsert.tfFirstNotif.focus();
        return false;
      }
	  // Enthält die erste Alarmierungszeit ungültige Zeichen?
      if(document.frmHostEscInsert.tfFirstNotif.value.match(/[^0-9]/))  {
        alert("{FILL_ILLEGCHAR1}\"{LANG_FIRSTNOTIF}\"{FILL_ILLEGCHAR3}");
        document.frmHostEscInsert.tfFirstNotif.focus();
        return false;
      }
      // Fehlt die letzte Alarmierungszeit?
      if(document.frmHostEscInsert.tfLastNotif.value == "") {
        alert("{FILL_LASTNF}");
        document.frmHostEscInsert.tfLastNotif.focus();
        return false;
      }
      // Enthält die letzte Alarmierungszeit ungültige Zeichen?
      if(document.frmHostEscInsert.tfLastNotif.value.match(/[^0-9]/))  {
        alert("{FILL_ILLEGCHAR1}\"{LANG_LASTNOTIF}\"{FILL_ILLEGCHAR3}");
        document.frmHostEscInsert.tfLastNotif.focus();
        return false;
      }
      // Fehlt das Alarmierungsintervall?
      if(document.frmHostEscInsert.tfNotifInterval.value == "") {
        alert("{FILL_NFINT}");
        document.frmHostEscInsert.tfNotifInterval.focus();
        return false;
      }
      // Enthält das Alarmierungsintervall ungültige Zeichen?
      if(document.frmHostEscInsert.tfNotifInterval.value.match(/[^0-9]/))  {
        alert("{FILL_ILLEGCHAR1}\"{LANG_NOTIFINTERV}\"{FILL_ILLEGCHAR3}");
        document.frmHostEscInsert.tfNotifInterval.focus();
        return false;
      }
      // Wurde eine Kontaktgruppe ausgewählt?
      if(document.frmHostEscInsert.selContactGroup.value == 0) {
        alert("{FILL_CGROUP}");
        document.frmHostEscInsert.selContactGroup.focus();
        return false;
      }
    }
  //-->
  </script>
  <table border="0"  class="inserttable">
      <tr>
      <td>{LANG_HOSTNAME}(*)</td>
      <td colspan="2" rowspan="2"><select name="selHost[]" size="8" multiple id="selHost" style="width:200px;" onChange="update()">
<!-- BEGIN host -->
          <option value="{DAT_HOST_ID}" {DAT_HOST_SEL}>{DAT_HOST}</option>
<!-- END host -->
        </select></td>
      <td>{LANG_HOSTGROUP}(*)</td>
      <td rowspan="2"><select name="selHostGroup[]" size="8" multiple id="selHostGroup" style="width:200px;">
<!-- BEGIN hostgroup -->
        <option value="{DAT_HOSTGROUP_ID}" {DAT_HOSTGROUP_SEL}>{DAT_HOSTGROUP}</option>
<!-- END hostgroup -->
      </select></td>
      </tr>
    <tr>
      <td><small>{LANG_CTRLINFO}</small></td>
      <td><small>{LANG_CTRLINFO}</small></td>
      </tr>
    <tr>
      <td>{LANG_CONFIGNAME}*</td>
      <td colspan="2"><input name="tfConfigName" type="text" id="tfConfigName" value="{DAT_CONFIG_NAME}" maxlength="40"></td>
      <td>{LANG_CONTACTGROUP}*</td>
      <td rowspan="4"><select name="selContactGroup[]" size="6" multiple id="selContactGroup" style="width:200px;">
<!-- BEGIN contactgroup -->
          <option value="{DAT_CONTACTGROUP_ID}" {DAT_CONTACTGROUP_SEL}>{DAT_CONTACTGROUP}</option>
<!-- END contactgroup -->
        </select> 
      </td>
    </tr>
    <tr>
      <td>{LANG_FIRSTNOTIF}*</td>
      <td colspan="2"><input name="tfFirstNotif" type="text" size="5" maxlength="5" value="{DAT_FIRST_NOTIFICATION}"></td>
      <td rowspan="3"><small>{LANG_CTRLINFO}</small></td>
    </tr>
    <tr>
      <td>{LANG_LASTNOTIF}*</td>
      <td colspan="2" valign="middle"><input name="tfLastNotif" type="text" size="5" maxlength="5" value="{DAT_LAST_NOTIFICATION}"></td>
    </tr>
    <tr>
      <td>{LANG_NOTIFINTERV}*</td>
      <td colspan="2" valign="middle"><input name="tfNotifInterval" type="text" size="5" maxlength="5" value="{DAT_NOTIFICATION_INTERVAL}"> min</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td colspan="2">&nbsp;</td>
      <td>{LANG_ESCPERIOD}</td>
      <td><select name="selEscPeriod" id="selEscPeriod" style="width:200px;">
<!-- BEGIN escperiod -->
        <option value="{DAT_ESCPERIOD_ID}" {DAT_ESCPERIOD_SEL}>{DAT_ESCPERIOD}</option>
<!-- END escperiod -->
      </select></td>
    </tr>
    <tr>
      <td>{LANG_ACTIVE}</td>
      <td colspan="2"><input name="chbActive" type="checkbox" class="checkbox" id="chbActive" value="1" {ACT_CHECKED}>
        <input name="modus" type="hidden" id="modus" value="{MODUS}">
        <input name="hidId" type="hidden" id="hidId" value="{DAT_ID}">
        <input name="hidLimit" type="hidden" id="hidLimit" value="{LIMIT}"></td>
      <td>{LANG_ESCOPTION}</td>
      <td><input name="chbEOd" type="checkbox" class="checkbox" id="chbEOd" value="d" {DAT_EOD_CHECKED}>
        d&nbsp;
        <input name="chbEOu" type="checkbox" class="checkbox" id="chbEOu" value="u" {DAT_EOU_CHECKED}>
        u&nbsp;
        <input name="chbEOr" type="checkbox" class="checkbox" id="chbEOr" value="r" {DAT_EOR_CHECKED}>
        r</td>
    </tr>
    <tr>
      <td><img src="{IMAGE_PATH}pixel.gif" alt="" width="150" height="1"></td>
      <td><img src="{IMAGE_PATH}pixel.gif" alt="" width="120" height="1"></td>
      <td><img src="{IMAGE_PATH}pixel.gif" alt="" width="130" height="1"></td>
      <td><img src="{IMAGE_PATH}pixel.gif" alt="" width="140" height="1"></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td colspan="2"><input name="subForm" type="button" id="subForm" value="{LANG_SAVE}" onClick="LockButton()">
      &nbsp;<input name="subAbort" type="button" id="subAbort" onClick="abort()" value="{LANG_ABORT}"></td>
      <td>{LANG_MUSTDATA}</td>
      <td colspan="2"><span class="dbmessage">{WARNING}</span></td>
    </tr>
  </table>
</form>
<br>
<!-- END datainsert -->